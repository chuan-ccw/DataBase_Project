<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>訂單明細</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        .container { max-width: 900px; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        .info-box { background-color: #e9ecef; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .info-row { margin-bottom: 8px; font-size: 1.1em; }
        .total-row { font-weight: bold; font-size: 1.2em; text-align: right; margin-top: 15px; }
        .total-amount { color: #d32f2f; font-size: 1.3em; }
        /* 調整 badge 字體大小與間距，讓它看起來更像按鈕風格 */
        .badge { font-size: 0.95em; padding: 6px 10px; font-weight: normal; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="mb-4">訂單詳細資訊</h2>

        {% if order_info %}
        <div class="info-box">
            <div class="row">
                <div class="col-md-6">
                    <div class="info-row"><strong>訂單編號：</strong> {{ order_info.order_id }}</div>
                    <div class="info-row"><strong>顧客電話：</strong> {{ order_info.phone }}</div>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="info-row"><strong>狀態：</strong> 
                        {% if order_info.status == '已完成' %}
                            <span class="badge bg-success">{{ order_info.status }}</span>
                        {% else %}
                            <span class="badge bg-warning text-dark">{{ order_info.status }}</span>
                        {% endif %}
                    </div>
                    <div class="info-row"><strong>訂單總額：</strong> ${{ order_info.tot_price }}</div>
                </div>
            </div>
        </div>

        <h4 class="mb-3">飲品明細列表</h4>
        <table class="table table-striped table-hover align-middle text-center">
            <thead class="table-dark">
                <tr>
                    <th>序號</th>
                    <th>品名</th>
                    <th>尺寸</th>
                    <th>冰量</th>
                    <th>甜度</th>
                    <th>加料</th>
                    <th>數量</th>
                    <th>單價</th>
                    <th>小計</th>
                </tr>
            </thead>
            <tbody>
                {% if items %}
                    {% for item in items %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ item.product_name }}</td>
                        
                        <td><span class="badge bg-secondary">{{ item.size }}</span></td>
                        
                        <td><span class="badge bg-info text-dark">{{ item.ice }}</span></td>
                        
                        <td><span class="badge bg-warning text-dark">{{ item.sugar }}</span></td>
                        
                        <td>
                            {% if item.topping and item.topping != '無' %}
                                <span class="badge bg-primary">{{ item.topping }}</span>
                            {% else %}
                                <span class="text-muted">-</span>
                            {% endif %}
                        </td>
                        
                        <td>{{ item.quantity }}</td>
                        <td>${{ item.price }}</td>
                        <td>${{ item.subtotal }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="9" class="text-center text-muted">查無明細資料</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>

        <div class="total-row border-top pt-3">
            總杯數：{{ total_qty }} 杯 &nbsp;&nbsp;|&nbsp;&nbsp; 
            總金額：<span class="total-amount">${{ total_price }}</span>
        </div>

        {% else %}
        <div class="alert alert-danger" role="alert">
            找不到這張訂單的基本資料。
        </div>
        {% endif %}

        <div class="mt-4 text-end">
            <a href="{{ url_for('admin_orders') }}" class="btn btn-secondary btn-lg">
                返回所有訂單
            </a>
        </div>
    </div>
</body>
</html>