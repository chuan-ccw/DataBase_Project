<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>目前訂單</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        .container { max-width: 900px; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        .page-header { border-bottom: 1px solid #eee; margin-bottom: 20px; padding-bottom: 10px; }
        .total-section { font-size: 1.2em; font-weight: bold; text-align: right; margin-top: 20px; padding-top: 20px; border-top: 2px solid #eee; }
        .total-price { color: #d32f2f; font-size: 1.4em; }
        .btn-action { min-width: 120px; }
        .store-badge { background-color: #e9ecef; color: #495057; padding: 2px 8px; border-radius: 4px; font-weight: bold; font-size: 0.9em; margin-right: 10px;}
        
        /* 統一 Badge 樣式 */
        .badge { font-size: 0.95em; padding: 6px 10px; font-weight: normal; }
    </style>
</head>
<body>

<div class="container">
    <div class="page-header d-flex justify-content-between align-items-center">
        <h2>目前訂單明細</h2>
        <div class="text-muted text-end">
            <span class="store-badge">店家：{{ store_name }}</span> 
            訂單編號：{{ order_id }}<br>
            顧客電話：{{ phone }}
        </div>
    </div>

    {% if items %}
    <table class="table table-hover align-middle text-center">
        <thead class="table-light">
            <tr>
                <th>品名</th>
                <th>尺寸</th>
                <th>冰量</th>
                <th>甜度</th>
                <th>加料</th>
                <th>數量</th>
                <th>單價</th>
                <th>小計</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.product_name }}</td>
                
                <td><span class="badge bg-secondary">{{ item.size }}</span></td>
                
                <td><span class="badge bg-info text-dark">{{ item.ice }}</span></td>
                
                <td><span class="badge bg-warning text-dark">{{ item.sugar }}</span></td>
                
                <td>
                    {% if item.topping and item.topping != '無' %}
                    <span class="badge bg-primary">{{ item.topping }}</span>
                    {% else %}
                    <span class="text-muted">-</span>
                    {% endif %}
                </td>
                
                <td>{{ item.quantity }}</td>
                <td>${{ item.price }}</td>
                <td>${{ item.subtotal }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="total-section">
        總杯數：{{ total_qty }} 杯 &nbsp;&nbsp;|&nbsp;&nbsp; 
        總金額：<span class="total-price">${{ total_price }}</span>
    </div>

    {% else %}
    <div class="alert alert-warning text-center" role="alert">
        目前訂單內沒有任何飲料。
    </div>
    {% endif %}

    <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('order_drink') }}" 
           class="btn btn-secondary btn-action btn-lg">
           返回點餐
        </a>

        {% if items %}
        <form action="{{ url_for('checkout') }}" method="POST">
            <input type="hidden" name="tot_price" value="{{ total_price }}">
            <input type="hidden" name="tot_amount" value="{{ total_qty }}">
            <button type="submit" class="btn btn-success btn-action btn-lg">確認結帳</button>
        </form>
        {% endif %}
    </div>
</div>

</body>
</html>